# Emergency-Simulator

#### agent的类型

##### 病人

- 病的类型
- 严重程度 (用于判断需要医生的级别和数量)
- 预计处理时间 ( 基础时间+浮动 )

##### 前台窗口 n个护士

- disponible
- X s判断一个人的状态 给出优先级
- 在这之后 病人获得优先级 根据优先级产生不同的行为
  - 9-10 直接去专科
  - 1-8 排队挂号

##### 挂号

- n个队伍 病人会优先选择人最少的排队
- 挂号所需的时间 ( 基础时间+浮动 )

##### 等待间

- 容量
- 等待医生传唤

##### 医生

- 级别 (高级的医生可以单独负责, 低级需要一起工作)

##### 房间

- 当一个房间空闲，主动判断最靠前的病人以及它所需的医生数量是否满足，满足就将医生和病人叫到房间进行问诊
- 特殊房间需要特殊判断，判断有无6-8等级的病人 有则需要则优先满足6-8病人

- 类型 (普通急诊 加急急诊 死亡急诊(暂时不做))



---





病人的流程为：

病人创建 - 医院门口排队等待护士 - 护士根据你的综合信息判断出问诊时间 - 排队挂号 - 挂号完成进入等候室 - 进行问诊 - 结束

前端每隔0.5s向后段发送一次请求，获取所有agent的状态，主要就是每个区域内的所有病人，并刷新展示页面

1. **创建病人的按钮**，病人对象在创建的时候，需要传入唯一参数病人症状等级，前端通过发送json数据到后端创建病人，后端将其加入等待队列
2. 有**一个护士等待队列**，所有的病人在被护士通知前会在此等候，有**n个护士台**(默认三个，可以增加或者减少，需要前端发送请求到后端)，当病人被护士通知后会在此处进行情况的判断
3. 在获得判断后，会进入挂号区域，有**n个挂号等待队列**(默认三个，可以增加或者减少，需要前端发送请求到后端)，病人择优等候。
4. 在挂号结束后，有一个**等候大厅**，所有挂完号的病人在此等候
5. 有**n个病房 **(默认5个 可以增加或者减少，更改也需要发送请求给后端，创建的时候需要向后端发送病房的等级)，每个病房都有对应的等级，只有等级高于这个病房的病人，才能使用这个等级的病房。



```go
// 请求护士 向nurse_center发送一个请求 nurse_center向某个护士发送请求 护士执行完后通过Msg_nurse告知病人
Msg_request_nurse     chan *Patient  // 向护士请求的信道
Msg_nurse             chan string    // 接受护士消息的信道

// 挂号相关 向Msg_request_reception发送挂号请求 从Msg_receive_reception接受挂号完成通知
Msg_request_reception chan *Patient  // 请求挂号的信道
Msg_receive_reception chan string    // 接受挂号的信道

// 看病 向Msg_request_waiting发送等候请求 拿到病人后，将其加入等候队列
Msg_request_waiting   chan *Patient  // 请求加入等待室候诊队列的信道

// 看病
waiting_room -> docter_center
             -> emergency_room
```

